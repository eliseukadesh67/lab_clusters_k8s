apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboard-http-overview
  namespace: observability
  labels:
    grafana_dashboard: "1"
data:
  http-overview.json: |
    {"title":"HTTP Services Overview","uid":"http-overview-pspd","timezone":"browser","schemaVersion":39,"version":1,"refresh":"30s","templating":{"list":[{"name":"datasource","type":"datasource","query":"prometheus","hide":0,"label":"Datasource","Current":{},"refresh":1}]},"panels":[{"type":"timeseries","title":"HTTP Requests per second (by service)","gridPos":{"x":0,"y":0,"w":12,"h":8},"datasource":{"type":"prometheus","uid":"${datasource}"},"targets":[{"expr":"sum by (service) (rate(http_requests_total[5m]))","legendFormat":"{{service}}"}]},{"type":"timeseries","title":"HTTP Error rate % (5xx)","gridPos":{"x":12,"y":0,"w":12,"h":8},"datasource":{"type":"prometheus","uid":"${datasource}"},"fieldConfig":{"defaults":{"unit":"percent"},"overrides":[]},"targets":[{"expr":"100 * (sum by (service) (rate(http_requests_total{status=~\"5..\"}[5m]) or rate(http_requests_total{status_code=~\"5..\"}[5m]))) / sum by (service) (rate(http_requests_total[5m]))","legendFormat":"{{service}}"}]},{"type":"timeseries","title":"HTTP P95 latency (s) by service","gridPos":{"x":0,"y":8,"w":12,"h":8},"datasource":{"type":"prometheus","uid":"${datasource}"},"targets":[{"expr":"histogram_quantile(0.95, sum by (le, service) (rate(http_request_duration_seconds_bucket[5m])))","legendFormat":"{{service}}"}]},{"type":"timeseries","title":"HTTP Requests by method","gridPos":{"x":12,"y":8,"w":12,"h":8},"datasource":{"type":"prometheus","uid":"${datasource}"},"targets":[{"expr":"sum by (service, method) (rate(http_requests_total[5m]))","legendFormat":"{{service}} {{method}}"}]}]}